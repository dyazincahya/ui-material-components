<template>
    <Page>
        <ActionBar :title="title">
            <NavigationButton text="Back" android.systemIcon="ic_menu_back" @tap="onNavigationButtonTap"></NavigationButton>
        </ActionBar>
        <StackLayout>
            <MDButton id="alert" text="alert" @tap="onTap" />
            <MDButton id="prompt" text="prompt" @tap="onTap" />
            <MDButton id="confirm" text="confirm" @tap="onTap" />
            <MDButton id="action" text="action" @tap="onTap" />
            <MDButton id="password" text="password" @tap="onTap" />
            <MDButton id="login" text="login" @tap="onTap" />
            <MDButton id="dialogCustomView" text="customView" @tap="onTap" />
            <MDButton id="alertdialog" text="alertdialog" @tap="onTap" />
        </StackLayout>
    </Page>
</template>

<script lang="ts" setup>
import { action, alert, AlertDialog, confirm, login, prompt } from '@nativescript-community/ui-material-dialogs';
import { ActivityIndicator, Color, EventData, Label as NSLabel, StackLayout as NSStackLayout, View } from '@nativescript/core';
import { inputType } from '@nativescript/core/ui/dialogs/dialogs-common';
import * as frameModule from '@nativescript/core/ui/frame';
import {ref, onMounted, onUnmounted} from "nativescript-vue";

const title = 'Dialogs sample';
const name = 'Dialogs';
const onTap = (args) =>{
  const obj = args.object as View;
  const objId = obj.id;
  console.log('onTap', objId, obj);
  switch (objId) {
    case 'alert': {
      alert('this is test Alert!').then((result) => console.log('alert result', result));
      break;
    }
    case 'dialogCustomView': {
      const label = new NSLabel();
      label.style.padding = 20;
      label.style.backgroundColor = new Color(255, 255, 0, 0);
      label.style.fontSize = 11;
      label.style.whiteSpace = 'normal';
      label.text = 'Un problème technique est survenu. Notre service technique en a été informé et traitera le problème dans les plus brefs délais.';

      alert({
        okButtonText: 'OK',
        // title: 'custom dialog view',
        context: {
          dataItems: ""
        },
        view: label as any
      }).then((result) => {
        alert(`closed  dialog with customview and result: ${result}`);
      });
      break;
    }
    case 'prompt': {
      console.log('about to prompt');
      prompt({
        // message: 'this is test Prompt!',
        okButtonText: 'OK',
        cancelButtonText: 'Cancel',
        buttonInkColor: new Color('yellow'),
        buttonTitleColor: new Color('blue'),
        title: null,
        textFieldProperties: {
          marginLeft: 20,
          marginRight: 50,
          hint: 'test hint text'
        },
        autoFocus: true
      }).then((result) => console.log('prompt result', result));
      break;
    }
    case 'confirm': {
      console.log('about to prompt');
      confirm({
        title: 'confirmtest',
        okButtonText: 'OK',
        cancelButtonText: 'Cancel'
      }).then((result) => console.log('confirm result', result));
      break;
    }
    case 'password': {
      console.log('about to prompt');
      prompt({
        title: 'Enter password',
        defaultText: '',
        okButtonText: 'OK',
        cancelButtonText: 'Cancel',
        inputType: inputType.password,
        textFieldProperties: {
          hint: 'password'
        }
      }).then((result) => console.log('prompt result', result));
      break;
    }
    case 'login': {
      console.log('about to login');
      login({
        message: 'this is test Prompt!',
        okButtonText: 'OK',
        cancelButtonText: 'Cancel',
        title: 'title?',
        userName: 'my username?',
        password: 'my password?'
      }).then((result) => console.log('login result', result));
      break;
    }
    case 'action': {
      console.log('about to action');
      action({
        message: 'this is test Prompt!',
        cancelButtonText: 'Cancel',
        title: 'title?',
        actions: ['action1', 'action2', 'action3']
      }).then((result) => console.log('action result', result));
      break;
    }

    case 'alertdialog':
      const stack = new NSStackLayout();
      stack.orientation = 'horizontal';
      stack.verticalAlignment = 'middle';
      // stack.height = {value:100, unit:'dip'};
      stack.padding = 24;
      // stack.margin = 30;
      stack.backgroundColor = 'red';
      const activityIndicator = new ActivityIndicator();
      activityIndicator.className = 'activity-indicator';
      activityIndicator.backgroundColor = 'yellow';
      activityIndicator.busy = true;
      activityIndicator.verticalAlignment = 'middle';
      stack.addChild(activityIndicator);
      const label = new NSLabel();
      label.verticalAlignment = 'middle';
      label.backgroundColor = 'brown';
      label.text = 'test';
      stack.addChild(label);
      const dialog = new AlertDialog({
        // title: 'tsst',
        // message: null,
        view: stack as any
      });
      dialog.show();
  }
}
const onNavigationButtonTap = () =>{
  frameModule.Frame.topmost().goBack();
}
</script>
